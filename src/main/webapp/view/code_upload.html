<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>作业上传</title>

    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">

    #include("_css.html")

</head>
<body>

#include("_navbar.html")

<div class="container-fluid">
    <div class="row">

        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                #include("_sidebar.html")
            </ul>
        </div>
        <input type="hidden" id="assignmentId" value="#(assignment.assignmentId)">
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <div class="row">
                <div class="col-md-12">
                    <div class="breadcrumb">
                        <li><a href="/info/classes">班级列表</a></li>
                        <li><a href="/info/assignments/#(assignment.classId)">作业列表</a></li>
                        <li><span>作业详情</span></li>
                    </div>
                </div>
            </div>
            <div class="col-md-12">

                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>题号</th>
                        <th>题目内容</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    #for(question : questionVoList)
                    <tbody>
                    <tr>
                        <td>#(question.questionNo)</td>
                        <td><pre>#(question.content)</pre></td>
                        <td>
                            <a href="/upload/edit?assignmentId=#(assignment.assignmentId)&questionId=#(question.questionId)" title="查看作业" class="btn btn-info btn-xs" data-toggle="tooltip" data-placement="bottom">
                                <i class="glyphicon glyphicon-list"></i>
                            </a>
                        </td>
                    </tr>
                    </tbody>
                    #end
                </table>
            </div>
        </div>
    </div>
</div>

#include("_js.html")

<script>
    $(function () {

        layui.use('upload', function () {
            var upload = layui.upload;

            //执行实例
            var uploadInst = upload.render({
                elem: '#upload-btn',
                url: '/upload/receive',
                accept: 'file',
                exts: 'zip',
                before: function (input) {
                    this.data = {'assignmentId': $('#assignmentId').val()};
                },
                done: function (data) {
                    //上传完毕回调
                    if (data.resCode === 0) {
                        layer.alert('系统将按照测试用例批改作业，请稍后查看批改结果');
                        setTimeout("location.reload()", 1000);
                    }
                    if (data.resCode === 1) {
                        layer.alert(data.errorMsg);
                    }
                },
                error: function () {
                    //请求异常回调
                    layer.alert('作业上传失败，请重新上传');
                }
            });
        });
    });
</script>
</body>

</html>
