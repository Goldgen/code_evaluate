<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>批改结果</title>

    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">

    #include("_css.html")

</head>
<body>

#include("_navbar.html")


<div class="container-fluid">
    <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li><a href="/assignment/detail/#(assignment.assignmentId)-test_case_edit">测试用例编辑</a></li>
                <li><a href="/assignment/detail/#(assignment.assignmentId)-code_upload">作业上传</a></li>
                <li class="active"><a href="/assignment/detail/#(assignment.assignmentId)-execute_result">批改结果查看</a>
                </li>
                <li><a href="/assignment/detail/#(assignment.assignmentId)-similarity_analysis">相似度分析</a></li>
            </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

            #if(assignment.status==-1)
            <label class="text-danger">作业未提交</label>
            #else if(!assignment.isEvaluateFinish)
            <label class="text-danger">作业未批改完成</label>
            #else
            <label class="text-danger">最新批改时间：#(assignment.evaluateTime.toString().substring(0, 19))</label>
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>学号</th>
                    <th>姓名</th>
                    <th>总分</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                #for(executeResult : executeResultVoList)
                <tr>
                    <td>#(executeResult.studentId)</td>
                    <td>#(executeResult.studentName)</td>
                    <td>#(executeResult.score)</td>
                    <td>
                        #for(x : executeResult.questionResultList)
                        <input type="hidden" id="#(executeResult.studentId)-#(x.questionNo)"
                               data-question-no="#(x.questionNo)"
                               data-is-compile-pass="#if(x.isCompilePass)是#else否#end"
                               data-test-case-score="#(x.testCaseScore)" data-evaluate-score="#(x.evaluateScore)">
                        #end
                        <a href="javascript:void(0)" class="btn btn-info btn-xs detail-info-btn" title="批改详情"
                           data-toggle="tooltip" data-placement="bottom"><i
                                class="glyphicon glyphicon-list"></i></a>
                    </td>
                </tr>
                #end
                </tbody>
            </table>
            #end
        </div>
    </div>
</div>
</div>

<div class="modal fade" id="detailModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="modal-title">批改详情</h4>
            </div>
            <div class="modal-body">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>题号</th>
                        <th>是否编译通过</th>
                        <th>测试用例得分</th>
                        <th>静态分析得分</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>


#include("_js.html")

</body>
<script>

    $(function () {

        $('[data-toggle="tooltip"]').tooltip();

        $('.detail-info-btn').click(function () {
            $('.modal-body').find('tbody').empty();
            var inputElements = $(this).closest('td').find('input');
            inputElements.each(function (index, element) {
                var questionNo = $(element).data('question-no');
                var isCompilePass = $(element).data('is-compile-pass');
                var testCaseScore = $(element).data('test-case-score');
                var evaluateScore = $(element).data('evaluate-score');
                var html = '<tr>' +
                    '<td>' + questionNo + '</td>' +
                    '<td>' + isCompilePass + '</td>\n' +
                    '<td>' + testCaseScore + '</td>\n' +
                    '<td>' + evaluateScore + '</td>\n' +
                    '</tr>';
                $('.modal-body').find('tbody').append(html);
            });
            $('#detailModal').modal('toggle');
        });


    });
</script>
</html>
